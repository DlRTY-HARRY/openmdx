<?xml version="1.0" encoding="UTF-8"?>
<!--
/*******************************************************************

Copyright (c) 2004 Open Mobile Alliance, Ltd.  All Rights Reserved.

This software is made available under the usage and distribution terms 
covered by the Common Public License 1.0 and by using this software you
are bound by the terms and conditions of the same.

EXCEPT AS EXPRESSLY SET FORTH IN THE COMMON PUBLIC LICENSE,
THIS PROGRAM IS PROVIDED ON AN "AS IS" BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, 
EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, 
ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, 
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
   
Each recipient is solely responsible for determining the 
appropriateness of using and distributing this program and assumes 
all risks associated with its exercise of rights under the Common 
Public License, including but not limited to the risks and 
costs of program errors, compliance with applicable laws, 
damage to or loss of data, programs or equipment, and 
unavailability or interruption of operations.

********************************************************************/
 -->
<!--SCTSClient can handle the packages recvd across multiple messages -->
<TestCase Id="DS-V1.2-server-con-0101">
    <!--To check if the Test Oject Implements server Layer Authentication,SCTS send SyncHdr with wrong credentials-->
    <!--Set the MaxMssg size and MaxObject Size to zero  -->
    <SCTSSet attrib="MaxMsgSize" param1="5000"/>
    <SCTSSet attrib="executionResult" param1="Success"/>
    <SCTSSet attrib="MaxObjSize" param1="0"/>
    <SCTSSet attrib="sessionID" param1="1"/>
    <SCTSSet attrib="msgID" param1="0"/>
    <SCTSOP OP="SCTSDatabase.generateNextAnchor()" return="localNextAnchor"/>
    <SCTSSet attrib="CorrectCredentials" param1="-1"/>
    <!--In this send v check.....V ll nt send the credentails-->
    <SCTSLoop>
        <SCTSSend>
            <SyncML xmlns="SYNCML:SYNCML1.2">
                <SyncHdr>
                    <VerDTD>1.2</VerDTD>
                    <VerProto>SyncML/1.2</VerProto>
                    <SessionID>
                        <SCTSContent>SCTSObject.sessionID</SCTSContent>
                    </SessionID>
                    <MsgID>
                        <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                        <SCTSContent>SCTSObject.msgID</SCTSContent>
                    </MsgID>
                    <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                    <Target>
                        <LocURI>
                            <SCTSContent>SCTSObject.targetID</SCTSContent>
                        </LocURI>
                    </Target>
                    <Source>
                        <LocURI>
                            <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                            <SCTSContent> SCTSObject.sourceID</SCTSContent>
                        </LocURI>
                        <LocName>
                            <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                            <SCTSContent>SCTSObject.sourceName</SCTSContent>
                        </LocName>
                    </Source>
                    <!--If this is a First send then send the wrong cradentails say we ll send by default basic wrong credentials-->
                    <SCTSIf param1="SCTSObject.CurrRecv" param2="SCTSNULL" OP="EQ">
                        <SCTSSet attrib="CorrectCredentials" param1="0"/>
                        <Cred>
                            <Meta>
                                <Format xmlns="syncml:metinf">
                                    <SCTSContent>b64</SCTSContent>
                                </Format>
                                <Type xmlns="syncml:metinf">
                                    <SCTSContent>syncml:auth-basic</SCTSContent>
                                </Type>
                            </Meta>
                            <Data>
                                <SCTSContent>U2FtcGxlU2VydmVyOmFtcGxlU2VydmVy</SCTSContent>
                            </Data>
                        </Cred>
                    </SCTSIf>
                    <SCTSIf param1="SCTSObject.CurrRecv" param2="SCTSNULL" OP="NE">
                        <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal"
                            return="Chal" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.Chal" param2="SCTSNULL" OP="EQ">
                            <SCTSSet attrib="executionResult" param1="Failed"/>
                            <SCTSSet attrib="FailureReason" param1="AuthenticationFailed:Chal expected"/>
                        </SCTSIf>
                        <SCTSIf param1="SCTSObject.CorrectCredentials" param2="0" OP="EQ">
                            <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']/Data"
                                return="SyncHdrStatus" target="CurrRecv"/>
                            <SCTSIf param1="SCTSObject.SyncHdrStatus" param2="401" OP="NE">
                                <SCTSSet attrib="executionResult" param1="Failed"/>
                                <SCTSSet attrib="FailureReason" param1="Failed:Status 401 expected"/>
                            </SCTSIf>
                        </SCTSIf>
                        <!--If there is chal in the curr recv -->
                        <SCTSIf param1="SCTSObject.Chal" param2="SCTSNULL" OP="NE">
                            <!--Send the credentails -->
                            <SCTSSet attrib="CorrectCredentials" param1="1"/>
                            <Cred>
                                <Meta>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Format"
                                        return="authFormat" target="CurrRecv"/>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Type"
                                        return="authType" target="CurrRecv"/>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//NextNonce"
                                        return="NextNonce" target="CurrRecv"/>
                                    <SCTSIf param1="SCTSObject.authFormat" param2="SCTSNULL" OP="EQ">
                                        <SCTSSet attrib="authFormat" param1="b64"/>
                                    </SCTSIf>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                    </SCTSIf>
                    <!--Send the Max Mxg size the client can handle -->
                    <SCTSOP OP="SCTSContext.getLocalMaxMsgSize()" return="MaxMsgSize"/>
                    <Meta>
                        <MaxMsgSize xmlns="syncml:metinf">
                            <SCTSContent> SCTSObject.MaxMsgSize </SCTSContent>
                        </MaxMsgSize>
                    </Meta>
                </SyncHdr>
                <SyncBody>
                    <SCTSSet attrib="cmdIDNo" param1="1"/>
                    <SCTSIf param1="SCTSObject.CurrRecv" param2="SCTSNULL" OP="NE">
                        <!--If this is not a first send ..then build the status for curr Recv -->
                        <Status>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <CmdRef>0</CmdRef>
                            <Cmd>SyncHdr</Cmd>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Cred" return="Cred" target="CurrRecv"/>
                            <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="NE">
                                <Data>
                                    <SCTSContent> 212 </SCTSContent>
                                </Data>
                            </SCTSIf>
                            <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="EQ">
                                <Data>
                                    <SCTSContent> 200 </SCTSContent>
                                </Data>
                            </SCTSIf>
                        </Status>
                    </SCTSIf>
                    <!--Build the alerts for each Database,the Client wants to Sync -->
                    <SCTSSet attrib="DBIndex" param1="0"/>
                    <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                    <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                        <SCTSLoop>
                            <SCTSExpr param1="SCTSObject.DBIndex" param2="1" return="DBIndex" OP="PLUS"/>
                            <!--Get the current DB Node -->
                            <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                                param1="SCTSObject.DBIndex" return="CurrDBLocURI"/>
                            <!--Fetch the matching target for the above source -->
                            <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                            <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                param1="SCTSObject.locMime" return="targetDBLocURI"/>
                            <Alert>
                                <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                <CmdID>
                                    <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                </CmdID>
                                <!--what ever may b force the slow sync -->
                                <Data> 201</Data>
                                <Item>
                                    <Source>
                                        <LocURI>
                                            <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                        </LocURI>
                                    </Source>
                                    <Target>
                                        <LocURI>
                                            <SCTSContent> SCTSObject.targetDBLocURI</SCTSContent>
                                        </LocURI>
                                    </Target>
                                    <Meta>
                                        <Anchor xmlns="syncml:metinf">
                                            <Next>
                                                <SCTSContent>SCTSObject.localNextAnchor</SCTSContent>
                                            </Next>
                                        </Anchor>
                                    </Meta>
                                </Item>
                            </Alert>
                            <SCTSIf param1="SCTSObject.DBIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                                <!--If v built sync for all the dbsthen break from the loop -->
                                <SCTSBreak/>
                            </SCTSIf>
                        </SCTSLoop>
                    </SCTSIf>
                    <Final/>
                </SyncBody>
            </SyncML>
        </SCTSSend>
        <!--Get the response  -->
        <SCTSRecv/>
        <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
        <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
            <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
        </SCTSIf>
        <!--If the status for syncHdr v sent is 212(Authentication accepted) -->
        <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']/Data" return="AuthStatus" target="CurrRecv"/>
        <SCTSIf param1="SCTSObject.AuthStatus" param2="212" OP="EQ">
            <SCTSBreak/>
        </SCTSIf>
        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
            <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
            <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                    return="NextNonce" target="CurrRecv"/>
            </SCTSIf>
            <SCTSBreak/>
        </SCTSIf>
        <!--Check whether v sent true credentials allready -->
        <SCTSIf param1="SCTSObject.CorrectCredentials" param2="1" OP="EQ">
            <!--status for synchdr is not 212/200 and if v have sent credentials , then it is authentication fail-->
            <SCTSSet attrib="executionResult" param1="Failed"/>
            <SCTSSet attrib="FailureReason" param1="AuthenticationFailed"/>
            <!--So abort the current session -->
            <SCTSExit/>
        </SCTSIf>
    </SCTSLoop>
    <!--Client Sync send -->
    <!--In the below send v ll send the modifications from client and v ll assume that since server can handle large messges and large objects..
        all modifiacations ll fit in one package, But since server side control is not with us..server may send modifications across multiple messages
        or data by chunking , V shud in a postion to handle that-->
    <SCTSSend>
        <!--Say v ll assume that client sends all modifications in one messgae  -->
        <SyncML xmlns="SYNCML:SYNCML1.2">
            <SyncHdr>
                <VerDTD>1.2</VerDTD>
                <VerProto>SyncML/1.2</VerProto>
                <SessionID>
                    <SCTSContent>SCTSObject.sessionID</SCTSContent>
                </SessionID>
                <MsgID>
                    <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                    <SCTSContent>SCTSObject.msgID</SCTSContent>
                </MsgID>
                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="targetID"/>
                <Target>
                    <LocURI>
                        <SCTSContent>SCTSObject.targetID</SCTSContent>
                    </LocURI>
                </Target>
                <Source>
                    <LocURI>
                        <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                        <SCTSContent> SCTSObject.sourceID</SCTSContent>
                    </LocURI>
                    <LocName>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                        <SCTSContent>SCTSObject.sourceName</SCTSContent>
                    </LocName>
                </Source>
                <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                    <Cred>
                        <Meta>
                            <Format xmlns="syncml:metinf">
                                <SCTSContent>SCTSObject.authFormat</SCTSContent>
                            </Format>
                            <Type xmlns="syncml:metinf">
                                <SCTSContent>SCTSObject.authType</SCTSContent>
                            </Type>
                        </Meta>
                        <SCTSOP OP="SCTSContext.getRemoteCredentials()" param1="SCTSObject.authType"
                            param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                        <Data>
                            <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                        </Data>
                    </Cred>
                </SCTSIf>
            </SyncHdr>
            <SyncBody>
                <Status>
                    <SCTSSet attrib="cmdIDNo" param1="1"/>
                    <CmdID>
                        <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                    </CmdID>
                    <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                    <MsgRef>
                        <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                    </MsgRef>
                    <CmdRef>0</CmdRef>
                    <Cmd>SyncHdr</Cmd>
                    <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                    <TargetRef>
                        <SCTSContent>SCTSObject.targetID</SCTSContent>
                    </TargetRef>
                    <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                    <SourceRef>
                        <SCTSContent> SCTSObject.sourceID </SCTSContent>
                    </SourceRef>
                    <Data>
                        <SCTSContent> 200 </SCTSContent>
                    </Data>
                </Status>
                <!--Build the status for alerts recvd -->
                <SCTSSet attrib="LoopIndex" param1="1"/>
                <!--Get the number of alerts in the CurrRecv -->
                <SCTSExecutePath xpath="count(/SyncML/SyncBody/Alert)" return="NumOfAlerts" target="CurrRecv"/>
                <SCTSIf param1="SCTSObject.NumOfAlerts" param2="0" OP="GT">
                    <SCTSLoop>
                        <SCTSExpr param1="/SyncML/SyncBody/Alert[" param2="SCTSObject.LoopIndex"
                            return="xPathQuerry" OP="PLUS"/>
                        <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]" return="xPathQuerry" OP="PLUS"/>
                        <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrAlert" target="CurrRecv"/>
                        <!--Fetch the anchors in the recvd alert,since it is slow sync just fetch the Next anchor -->
                        <SCTSExecutePath xpath="Item/Meta/Anchor/Next" return="recvdNext" target="CurrAlert"/>
                        <SCTSExecutePath xpath="Item/Source/LocURI" return="targetID" target="CurrAlert"/>
                        <SCTSOP OP="SCTSDatabase.setRemoteNextAnchor()" param1="SCTSObject.targetID"
                            param2="SCTSObject.recvdNext" return="status"/>
                        <Status>
                            <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrAlert"/>
                            <CmdRef>
                                <SCTSContent> SCTSObject.cmdRef </SCTSContent>
                            </CmdRef>
                            <Cmd>Alert</Cmd>
                            <SCTSExecutePath xpath="Item/Target/LocURI" return="targetID" target="CurrAlert"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="Item/Source/LocURI" return="sourceID" target="CurrAlert"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <Data>
                                <SCTSContent>200</SCTSContent>
                            </Data>
                            <Item>
                                <Data>
                                    <Anchor xmlns="syncml:metinf">
                                        <Next>
                                            <SCTSContent> SCTSObject.recvdNext </SCTSContent>
                                        </Next>
                                    </Anchor>
                                </Data>
                            </Item>
                        </Status>
                        <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfAlerts" OP="EQ">
                            <SCTSBreak/>
                        </SCTSIf>
                        <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" OP="PLUS" return="LoopIndex"/>
                    </SCTSLoop>
                </SCTSIf>
                <!--Send the sync -->
                <!-- For each database we have ..send the sync-->
                <!--Build the sync for each database the SCTS supports -->
                <SCTSSet attrib="DBIndex" param1="0"/>
                <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                    <SCTSLoop>
                        <SCTSExpr param1="SCTSObject.DBIndex" param2="1" return="DBIndex" OP="PLUS"/>
                        <!--Get the current DB Node -->
                        <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                            param1="SCTSObject.DBIndex" return="CurrDBLocURI"/>
                        <Sync>
                            <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                            <CmdID>
                                <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                            </CmdID>
                            <Source>
                                <LocURI>
                                    <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                </LocURI>
                            </Source>
                            <!--Fetch the matching target for the above source -->
                            <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                            <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                param1="SCTSObject.locMime" return="targetID"/>
                            <Target>
                                <LocURI>
                                    <SCTSContent>SCTSObject.targetID</SCTSContent>
                                </LocURI>
                            </Target>
                        </Sync>
                        <SCTSIf param1="SCTSObject.DBIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                            <!--If v built sync for all the dbsthen break from the loop -->
                            <SCTSBreak/>
                        </SCTSIf>
                    </SCTSLoop>
                </SCTSIf>
                <Final/>
            </SyncBody>
        </SyncML>
    </SCTSSend>
    <!--ServerSync Send -->
    <SCTSLoop>
        <!--The below recv(package #4) ...ll have status for modificatins sent in prev send(package #3) ...and modifications from server(Modifications may run across multiple messges) -->
        <SCTSRecv/>
        <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
            <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
        </SCTSIf>
        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
            <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
            <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                    return="NextNonce" target="CurrRecv"/>
            </SCTSIf>
        </SCTSIf>
        <!--In the next send Build the status for adds and send Maps for completly recvd adds -->
        <SCTSSend>
            <SyncML xmlns="SYNCML:SYNCML1.2">
                <SyncHdr>
                    <VerDTD>1.2</VerDTD>
                    <VerProto>SyncML/1.2</VerProto>
                    <SessionID>
                        <SCTSContent>SCTSObject.sessionID</SCTSContent>
                    </SessionID>
                    <MsgID>
                        <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                        <SCTSContent>SCTSObject.msgID</SCTSContent>
                    </MsgID>
                    <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="targetID"/>
                    <Target>
                        <LocURI>
                            <SCTSContent>SCTSObject.targetID</SCTSContent>
                        </LocURI>
                    </Target>
                    <Source>
                        <LocURI>
                            <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                            <SCTSContent> SCTSObject.sourceID</SCTSContent>
                        </LocURI>
                        <LocName>
                            <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                            <SCTSContent>SCTSObject.sourceName</SCTSContent>
                        </LocName>
                    </Source>
                    <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                        <Cred>
                            <Meta>
                                <Format xmlns="syncml:metinf">
                                    <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                </Format>
                                <Type xmlns="syncml:metinf">
                                    <SCTSContent>SCTSObject.authType</SCTSContent>
                                </Type>
                            </Meta>
                            <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                            <Data>
                                <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                            </Data>
                        </Cred>
                    </SCTSIf>
                </SyncHdr>
                <SyncBody>
                    <Status>
                        <SCTSSet attrib="cmdIDNo" param1="1"/>
                        <CmdID>
                            <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                        </CmdID>
                        <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                        <MsgRef>
                            <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                        </MsgRef>
                        <CmdRef>0</CmdRef>
                        <Cmd>SyncHdr</Cmd>
                        <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                        <TargetRef>
                            <SCTSContent>SCTSObject.targetID</SCTSContent>
                        </TargetRef>
                        <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                        <SourceRef>
                            <SCTSContent> SCTSObject.sourceID </SCTSContent>
                        </SourceRef>
                        <Data>
                            <SCTSContent> 200 </SCTSContent>
                        </Data>
                    </Status>
                    <!--Build the status for each sync recvd from server  -->
                    <SCTSSet attrib="LoopIndex" param1="1"/>
                    <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="CurrRecv"/>
                    <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                        <SCTSLoop>
                            <!--Get the cuurrent SyncNode -->
                            <SCTSExpr param1="/SyncML/SyncBody/Sync[" param2="SCTSObject.LoopIndex"
                                return="xPathQuerry" OP="PLUS"/>
                            <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                return="xPathQuerry" OP="PLUS"/>
                            <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="CurrRecv"/>
                            <Status>
                                <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                <CmdID>
                                    <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                </CmdID>
                                <MsgRef>
                                    <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                </MsgRef>
                                <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrSync"/>
                                <CmdRef>
                                    <SCTSContent>SCTSObject.cmdRef</SCTSContent>
                                </CmdRef>
                                <Cmd>Sync</Cmd>
                                <SCTSExecutePath xpath="Target/LocURI" return="TargetDB" target="CurrSync"/>
                                <SCTSExecutePath xpath="Source/LocURI" return="SourceDB" target="CurrSync"/>
                                <TargetRef>
                                    <SCTSContent>SCTSObject.TargetDB</SCTSContent>
                                </TargetRef>
                                <SourceRef>
                                    <SCTSContent>SCTSObject.SourceDB</SCTSContent>
                                </SourceRef>
                                <Data>200</Data>
                            </Status>
                            <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                <SCTSBreak/>
                            </SCTSIf>
                            <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" return="LoopIndex" OP="PLUS"/>
                        </SCTSLoop>
                    </SCTSIf>
                    <!--Check whether v recvd Final in the prev recv. If there is Final ...it shows the end of package #4...ao v can end this current package #6 -->
                    <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
                    <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
                        <!--If there if Final end the package#5 -->
                        <Final/>
                    </SCTSIf>
                </SyncBody>
            </SyncML>
        </SCTSSend>
        <!-- here v have to decide whether goto recieving package #6 or loop bk to another message of package #5:Itz ll depends on final in the prev Recv-->
        <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
        <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
            <!--If there is  if Final in the package#5 then break-->
            <SCTSBreak/>
        </SCTSIf>
    </SCTSLoop>
    <!--So if there is final(or end of package #4 and hence #5) recv the next package #6 -; package #6 ll have status for Maps sent in package #5 -->
    <SCTSRecv/>
    <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
        <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
    </SCTSIf>
</TestCase>
