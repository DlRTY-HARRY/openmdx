<?xml version="1.0" encoding="UTF-8"?>
<!--
/*******************************************************************

Copyright (c) 2004 Open Mobile Alliance, Ltd.  All Rights Reserved.

This software is made available under the usage and distribution terms 
covered by the Common Public License 1.0 and by using this software you
are bound by the terms and conditions of the same.

EXCEPT AS EXPRESSLY SET FORTH IN THE COMMON PUBLIC LICENSE,
THIS PROGRAM IS PROVIDED ON AN "AS IS" BASIS, 
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, 
EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, 
ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, 
MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
   
Each recipient is solely responsible for determining the 
appropriateness of using and distributing this program and assumes 
all risks associated with its exercise of rights under the Common 
Public License, including but not limited to the risks and 
costs of program errors, compliance with applicable laws, 
damage to or loss of data, programs or equipment, and 
unavailability or interruption of operations.

********************************************************************/
 -->
<!--SCTSClient can handle the packages recvd across multiple messages -->
<TestCase Id="DS-V1.2-server-con-0505">
    <!--To check if the TestObject handles a Replace on a non existent Data Item as add -->
    <!--Set the MaxMssg size and MaxObject Size to zero  -->
    <SCTSSession>
        <SCTSSet attrib="SCTSMaxMsgSize" param1="5000"/>
        <SCTSSet attrib="TOMaxMsgSize" param1="5000"/>
        <SCTSSet attrib="executionResult" param1="Success"/>
        <SCTSSet attrib="MaxObjSize" param1="0"/>
        <SCTSSet attrib="sessionID" param1="1"/>
        <SCTSSet attrib="msgID" param1="0"/>
        <SCTSOP OP="SCTSDatabase.generateNextAnchor()" return="localNextAnchor"/>
        <!--Add a record in each database to local store the remote device supports -->
        <SCTSSet attrib="DBIndex" param1="1"/>
        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
            <SCTSLoop>
                <!--Get the current DB Node -->
                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()" param1="SCTSObject.DBIndex" return="CurrDBLocURI"/>
                <!--Fetch the Mime Type for the above source -->
                <SCTSOP OP="SCTSContext.getLocalMimeType()" param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                <!--create the Database -->
                <SCTSOP OP="SCTSDatabase.createDB()" param1="SCTSObject.CurrDBLocURI"
                    param2="SCTSObject.locMime" return="CreateStatus"/>
                <!--Fetch the sample data for the current mime type -->
                <SCTSOP OP="SCTSDatabase.getSampleAddData()" param1="SCTSObject.locMime" param2="1" return="SampleData"/>
                <!--Since it is a Client generate LUID -->
                <SCTSOP OP="SCTSDatabase.generateLUID()" return="LUID"/>
                <!--Inser the data to local store  -->
                <SCTSOP OP="SCTSDatabase.insertRawItem()" param1="SCTSObject.CurrDBLocURI"
                    param2="SCTSObject.SampleData" param3="SCTS" param4="SCTSObject.LUID"
                    param5="SCTSNULL" return="InsertStatus"/>
                <SCTSIf param1="SCTSObject.DBIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                    <!--If v added for all the dbsthen break from the loop -->
                    <SCTSBreak/>
                </SCTSIf>
                <SCTSExpr param1="SCTSObject.DBIndex" param2="1" return="DBIndex" OP="PLUS"/>
            </SCTSLoop>
        </SCTSIf>
        <SCTSLoop>
            <SCTSSend>
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal"
                            return="Chal" target="CurrRecv"/>
                        <!--If there is chal in the curr recv -->
                        <SCTSIf param1="SCTSObject.Chal" param2="SCTSNULL" OP="NE">
                            <!--Send the credentails -->
                            <Cred>
                                <Meta>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Format"
                                        return="authFormat" target="CurrRecv"/>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Type"
                                        return="authType" target="CurrRecv"/>
                                    <SCTSExecutePath
                                        xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//NextNonce"
                                        return="NextNonce" target="CurrRecv"/>
                                    <SCTSIf param1="SCTSObject.authFormat" param2="SCTSNULL" OP="EQ">
                                        <SCTSSet attrib="authFormat" param1="b64"/>
                                    </SCTSIf>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                        <!--Send the Max Mxg size the client can handle -->
                        <SCTSOP OP="SCTSContext.getLocalMaxMsgSize()" return="MaxMsgSize"/>
                        <Meta>
                            <MaxMsgSize xmlns="syncml:metinf">
                                <SCTSContent> SCTSObject.SCTSMaxMsgSize </SCTSContent>
                            </MaxMsgSize>
                        </Meta>
                    </SyncHdr>
                    <SyncBody>
                        <SCTSSet attrib="cmdIDNo" param1="1"/>
                        <SCTSIf param1="SCTSObject.CurrRecv" param2="SCTSNULL" OP="NE">
                            <!--If this is not a first send ..then build the status for curr Recv -->
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Meta/MaxMsgSize"
                                return="TempMaxMsgSize" target="CurrRecv"/>
                            <SCTSIf param1="SCTSObject.TempMaxMsgSize" param2="SCTSObject.SCTSNULL" OP="NE">
                                <SCTSSet attrib="TOMaxMsgSize" param1="SCTSObject.TempMaxMsgSize"/>
                            </SCTSIf>
                            <Status>
                                <CmdID>
                                    <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                </CmdID>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                                <MsgRef>
                                    <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                </MsgRef>
                                <CmdRef>0</CmdRef>
                                <Cmd>SyncHdr</Cmd>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI"
                                    return="targetID" target="CurrRecv"/>
                                <TargetRef>
                                    <SCTSContent>SCTSObject.targetID</SCTSContent>
                                </TargetRef>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI"
                                    return="sourceID" target="CurrRecv"/>
                                <SourceRef>
                                    <SCTSContent> SCTSObject.sourceID </SCTSContent>
                                </SourceRef>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Cred" return="Cred" target="CurrRecv"/>
                                <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="NE">
                                    <Data>
                                        <SCTSContent> 212 </SCTSContent>
                                    </Data>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="EQ">
                                    <Data>
                                        <SCTSContent> 200 </SCTSContent>
                                    </Data>
                                </SCTSIf>
                            </Status>
                        </SCTSIf>
                        <!--Build the alerts for each Database,the Client wants to Sync -->
                        <SCTSSet attrib="DBIndex" param1="0"/>
                        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                            <SCTSLoop>
                                <SCTSExpr param1="SCTSObject.DBIndex" param2="1" return="DBIndex" OP="PLUS"/>
                                <!--Get the current DB Node -->
                                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                                    param1="SCTSObject.DBIndex" return="CurrDBLocURI"/>
                                <!--Fetch the matching target for the above source -->
                                <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                    param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                                <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                    param1="SCTSObject.locMime" return="targetDBLocURI"/>
                                <Alert>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <!--what ever may b force the slow sync -->
                                    <Data> 201</Data>
                                    <Item>
                                        <Source>
                                            <LocURI>
                                                <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                            </LocURI>
                                        </Source>
                                        <Target>
                                            <LocURI>
                                                <SCTSContent> SCTSObject.targetDBLocURI</SCTSContent>
                                            </LocURI>
                                        </Target>
                                        <Meta>
                                            <Anchor xmlns="syncml:metinf">
                                                <Next>
                                                  <SCTSContent>SCTSObject.localNextAnchor</SCTSContent>
                                                </Next>
                                            </Anchor>
                                        </Meta>
                                    </Item>
                                </Alert>
                                <SCTSIf param1="SCTSObject.DBIndex"
                                    param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                                    <!--If v built sync for all the dbsthen break from the loop -->
                                    <SCTSBreak/>
                                </SCTSIf>
                            </SCTSLoop>
                        </SCTSIf>
                        <Final/>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <!--Get the response  -->
            <SCTSRecv/>
            <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
                <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
            </SCTSIf>
            <!--If the status for syncHdr v sent is 212(Authentication accepted) -->
            <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']/Data" return="AuthStatus" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="212" OP="EQ">
                <SCTSBreak/>
            </SCTSIf>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
                <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                    <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                        return="NextNonce" target="CurrRecv"/>
                </SCTSIf>
                <SCTSBreak/>
            </SCTSIf>
            <!--Check whether v sent credentials allready -->
            <SCTSExecutePath xpath="//Cred" return="Cred" target="CurrSend"/>
            <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="NE">
                <!--status for synchdr is not 212/200 and if v have sent credentials , then it is authentication fail-->
                <SCTSSet attrib="executionResult" param1="AuthenticationFailed"/>
                <SCTSSet attrib="FailureReason" param1="AuthenticationFailed"/>
                <!--So abort the current session -->
                <SCTSExit/>
            </SCTSIf>
        </SCTSLoop>
        <!--Client Sync send -->
        <SCTSSet attrib="ClientDBsIndex" param1="0"/>
        <SCTSSet attrib="ModIndex" param1="1"/>
        <SCTSLoop>
            <SCTSSend>
                <!--Say v ll assume that client sends all modifications in one messgae  -->
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                            <Cred>
                                <Meta>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                    </SyncHdr>
                    <SyncBody>
                        <Status>
                            <SCTSSet attrib="cmdIDNo" param1="1"/>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <CmdRef>0</CmdRef>
                            <Cmd>SyncHdr</Cmd>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <Data>
                                <SCTSContent> 200 </SCTSContent>
                            </Data>
                        </Status>
                        <!--Build the status for alerts recvd -->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <!--Get the number of alerts in the CurrRecv -->
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Alert)" return="NumOfAlerts" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.NumOfAlerts" param2="0" OP="GT">
                            <SCTSLoop>
                                <SCTSExpr param1="/SyncML/SyncBody/Alert["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrAlert" target="CurrRecv"/>
                                <!--Fetch the anchors in the recvd alert,since it is slow sync just fetch the Next anchor -->
                                <SCTSExecutePath xpath="Item/Meta/Anchor/Next" return="recvdNext" target="CurrAlert"/>
                                <SCTSExecutePath xpath="Item/Source/LocURI" return="targetID" target="CurrAlert"/>
                                <SCTSOP OP="SCTSDatabase.setRemoteNextAnchor()"
                                    param1="SCTSObject.targetID" param2="SCTSObject.recvdNext" return="status"/>
                                <Status>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                    </CmdID>
                                    <MsgRef>
                                        <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                    </MsgRef>
                                    <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrAlert"/>
                                    <CmdRef>
                                        <SCTSContent> SCTSObject.cmdRef </SCTSContent>
                                    </CmdRef>
                                    <Cmd>Alert</Cmd>
                                    <SCTSExecutePath xpath="Item/Target/LocURI" return="targetID" target="CurrAlert"/>
                                    <TargetRef>
                                        <SCTSContent>SCTSObject.targetID</SCTSContent>
                                    </TargetRef>
                                    <SCTSExecutePath xpath="Item/Source/LocURI" return="sourceID" target="CurrAlert"/>
                                    <SourceRef>
                                        <SCTSContent> SCTSObject.sourceID </SCTSContent>
                                    </SourceRef>
                                    <Data>
                                        <SCTSContent>200</SCTSContent>
                                    </Data>
                                    <Item>
                                        <Data>
                                            <Anchor xmlns="syncml:metinf">
                                                <Next>
                                                  <SCTSContent> SCTSObject.recvdNext </SCTSContent>
                                                </Next>
                                            </Anchor>
                                        </Data>
                                    </Item>
                                </Status>
                                <SCTSIf param1="SCTSObject.LoopIndex"
                                    param2="SCTSObject.NumOfAlerts" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" OP="PLUS" return="LoopIndex"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--#################################################################### -->
                        <!-- If the Package 3 is run into multiple meassages ..then v may recv status for ADD in the CurrRecv..as
                    response to earlier message of package#3 -->
                        <!--For all sync Nodes in the prev send ..check wether v sent any adds..so for the testcase to pass v must recv ststus 
                   201 each ADD-->
                        <!-- Check  weather v sent sync in the prev send-->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="PrevSend"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the cuurrent SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="PrevSend"/>
                                <!--get the targret uri -->
                                <SCTSExecutePath xpath="Target/LocURI" return="CurrDBLocURI" target="CurrSync"/>
                                <!--Check weatehr v sent any adds as part of this current sync -->
                                <SCTSExecutePath xpath="count(Add)" return="NumOfAdds" target="CurrSync"/>
                                <SCTSIf param1="SCTSObject.NumOfAdds" param2="0" OP="GT">
                                    <SCTSSet attrib="InnerLoopIndex" param1="1"/>
                                    <SCTSLoop>
                                        <!--Get the cuurrent AddNode -->
                                        <SCTSExpr param1="Add[" param2="SCTSObject.InnerLoopIndex"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExecutePath xpath="SCTSObject.xPathQuerry"
                                            return="CurrAdd" target="CurrSync"/>
                                        <!--Check for the status recvd  -->
                                        <SCTSExecutePath xpath="CmdID" return="sendCmdID" target="CurrAdd"/>
                                        <SCTSExpr param1="/SyncML/SyncBody/Status[CmdRef="
                                            param2="SCTSObject.sendCmdID" OP="PLUS" return="xpathString"/>
                                        <SCTSExpr param1="SCTSObject.xpathString" param2="]/Data"
                                            OP="PLUS" return="xpathString"/>
                                        <SCTSExecutePath xpath="SCTSObject.xpathString"
                                            target="CurrRecv" return="statusVal"/>
                                        <SCTSIf param1="SCTSObject.statusVal" param2="201" OP="NE">
                                            <SCTSSet attrib="executionResult" param1="Failed"/>
                                            <SCTSSet attrib="FailureReason" param1="Unexpected Status for Add"/>
                                        </SCTSIf>
                                        <SCTSIf param1="SCTSObject.InnerLoopIndex"
                                            param2="SCTSObject.NumOfAdds" OP="EQ">
                                            <SCTSBreak/>
                                        </SCTSIf>
                                        <SCTSExpr param1="SCTSObject.InnerLoopIndex" param2="1"
                                            return="InnerLoopIndex" OP="PLUS"/>
                                    </SCTSLoop>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--***************************************************************************************************** -->
                        <!--Build the sync for each database the SCTS supports -->
                        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Check wether next sync fits or not -->
                                <SCTSExecutePath xpath="string-length(/SyncML)" target="CurrSend" return="CurrentSize"/>
                                <!--25 bytes as to b reserved for </Final></SynaBody><SyncML> -->
                                <SCTSExpr param1="SCTSObject.CurrentSize" param2="25"
                                    return="tempSize" OP="PLUS"/>
                                <!--Say the size of next sync appr 200 bytes -->
                                <SCTSExpr param1="SCTSObject.tempSize" param2="200"
                                    return="syncTempSize" OP="PLUS"/>
                                <!--If the current sync unable to fit in then break from the loop -->
                                <SCTSIf param1="SCTSObject.syncTempSize"
                                    param2="SCTSObject.MaxMsgSize" OP="GT">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <!--Get the current DB Node -->
                                <SCTSExpr param1="SCTSObject.ClientDBsIndex" param2="1"
                                    return="TempClientDBsIndex" OP="PLUS"/>
                                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                                    param1="SCTSObject.TempClientDBsIndex" return="CurrDBLocURI"/>
                                <Sync>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <Source>
                                        <LocURI>
                                            <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                        </LocURI>
                                    </Source>
                                    <!--Fetch the matching target for the above source -->
                                    <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                        param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                                    <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                        param1="SCTSObject.locMime" return="targetID"/>
                                    <Target>
                                        <LocURI>
                                            <SCTSContent>SCTSObject.targetID</SCTSContent>
                                        </LocURI>
                                    </Target>
                                    <SCTSOP OP="SCTSDatabase.getNumberOfModifications() "
                                        param1="SCTSObject.CurrDBLocURI" param2="Add" return="NumOfAdds"/>
                                    <SCTSIf param1="SCTSObject.NumOfAdds" param2="0" OP="GT">
                                        <!--Get the modification list -->
                                        <SCTSLoop>
                                            <!--Fetch the current add  -->
                                            <SCTSOP OP="SCTSDatabase.getModificationOnIndex()"
                                                param1="SCTSObject.CurrDBLocURI" param2="Add"
                                                param3="SCTSObject.ModIndex" return="CurrAdd"/>
                                            <!--Find the size of the add -->
                                            <SCTSExecutePath xpath="string-length(DBRecord)"
                                                target="CurrAdd" return="AddSize"/>
                                            <SCTSExpr param1="SCTSObject.syncTempSize"
                                                param2="SCTSObject.AddSize" return="TotalMsgSize" OP="PLUS"/>
                                            <!--If the  current add  fits in-->
                                            <SCTSIf param1="SCTSObject.TotalMsgSize"
                                                param2="SCTSObject.MaxMsgSize" OP="LT">
                                                <Add>
                                                  <SCTSExpr param1="cmdIDNo" param2="1"
                                                  return="cmdIDNo" OP="PLUS"/>
                                                  <CmdID>
                                                  <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                                  </CmdID>
                                                  <Meta>
                                                  <Type xmlns="syncml:metinf">
                                                  <SCTSContent>SCTSObject.locMime</SCTSContent>
                                                  </Type>
                                                  </Meta>
                                                  <Item>
                                                  <Source>
                                                  <SCTSExecutePath xpath="DBLUID"
                                                  target="CurrAdd" return="LUID"/>
                                                  <LocURI>
                                                  <SCTSContent>SCTSObject.LUID</SCTSContent>
                                                  </LocURI>
                                                  </Source>
                                                  <SCTSExecutePath xpath="DBData"
                                                  target="CurrAdd" return="data"/>
                                                  <Data>
                                                  <SCTSContent>SCTSObject.data</SCTSContent>
                                                  </Data>
                                                  </Item>
                                                </Add>
                                            </SCTSIf>
                                            <SCTSIf param1="SCTSObject.ModIndex"
                                                param2="SCTSObject.NumOfAdds" OP="EQ">
                                                <SCTSSet attrib="ModIndex" param1="1"/>
                                                <SCTSExpr param1="SCTSObject.ClientDBsIndex"
                                                  param2="1" return="ClientDBsIndex" OP="PLUS"/>
                                                <SCTSBreak/>
                                            </SCTSIf>
                                            <SCTSExpr param1="SCTSObject.ModIndex" param2="1"
                                                return="ModIndex" OP="PLUS"/>
                                        </SCTSLoop>
                                    </SCTSIf>
                                    <!--If there is no modifictions to send then move to next sync -->
                                    <SCTSIf param1="SCTSObject.NumOfAdds" param2="0" OP="EQ">
                                        <SCTSExpr param1="SCTSObject.ClientDBsIndex" param2="1"
                                            return="ClientDBsIndex" OP="PLUS"/>
                                    </SCTSIf>
                                </Sync>
                                <SCTSIf param1="SCTSObject.ClientDBsIndex"
                                    param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                                    <!--If v built sync for all the dbsthen break from the loop -->
                                    <SCTSBreak/>
                                </SCTSIf>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--***************************************************************************************************** -->
                        <!--If v r able to send sync command for all dbs client support then end the package #4 -->
                        <SCTSIf param1="SCTSObject.ClientDBsIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                            <Final/>
                        </SCTSIf>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <SCTSBreak/>
        </SCTSLoop>
        <!--ServerSync Send -->
        <SCTSLoop>
            <!--The below recv(package #4) ...ll have status for modificatins sent in prev send(package #3) ...and modifications from server(Modifications may run across multiple messges) -->
            <SCTSRecv/>
            <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
                <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
            </SCTSIf>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
                <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                    <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                        return="NextNonce" target="CurrRecv"/>
                </SCTSIf>
            </SCTSIf>
            <!--In the next send Build the status for adds and send Maps for completly recvd adds -->
            <SCTSSend>
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                            <Cred>
                                <Meta>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                    </SyncHdr>
                    <SyncBody>
                        <Status>
                            <SCTSSet attrib="cmdIDNo" param1="1"/>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <CmdRef>0</CmdRef>
                            <Cmd>SyncHdr</Cmd>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <Data>
                                <SCTSContent> 200 </SCTSContent>
                            </Data>
                        </Status>
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="PrevSend"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the cuurrent SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="PrevSend"/>
                                <!--get the targret uri -->
                                <SCTSExecutePath xpath="Target/LocURI" return="CurrDBLocURI" target="CurrSync"/>
                                <!--Check weatehr v sent any adds as part of this current sync -->
                                <SCTSExecutePath xpath="count(Add)" return="NumOfAdds" target="CurrSync"/>
                                <SCTSIf param1="SCTSObject.NumOfAdds" param2="0" OP="GT">
                                    <SCTSSet attrib="InnerLoopIndex" param1="1"/>
                                    <SCTSLoop>
                                        <!--Get the cuurrent AddNode -->
                                        <SCTSExpr param1="Add[" param2="SCTSObject.InnerLoopIndex"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExecutePath xpath="SCTSObject.xPathQuerry"
                                            return="CurrAdd" target="CurrSync"/>
                                        <!--Check for the status recvd  -->
                                        <SCTSExecutePath xpath="CmdID" return="sendCmdID" target="CurrAdd"/>
                                        <SCTSExpr param1="/SyncML/SyncBody/Status[CmdRef="
                                            param2="SCTSObject.sendCmdID" OP="PLUS" return="xpathString"/>
                                        <SCTSExpr param1="SCTSObject.xpathString" param2="]/Data"
                                            OP="PLUS" return="xpathString"/>
                                        <SCTSExecutePath xpath="SCTSObject.xpathString"
                                            target="CurrRecv" return="statusVal"/>
                                        <SCTSIf param1="SCTSObject.statusVal" param2="201" OP="NE">
                                            <SCTSSet attrib="executionResult" param1="Failed"/>
                                            <SCTSSet attrib="FailureReason" param1="Unexpected Status for Add"/>
                                        </SCTSIf>
                                        <SCTSIf param1="SCTSObject.InnerLoopIndex"
                                            param2="SCTSObject.NumOfAdds" OP="EQ">
                                            <SCTSBreak/>
                                        </SCTSIf>
                                        <SCTSExpr param1="SCTSObject.InnerLoopIndex" param2="1"
                                            return="InnerLoopIndex" OP="PLUS"/>
                                    </SCTSLoop>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--Build the status for each sync recvd from server  -->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the cuurrent SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="CurrRecv"/>
                                <Status>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <MsgRef>
                                        <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                    </MsgRef>
                                    <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrSync"/>
                                    <CmdRef>
                                        <SCTSContent>SCTSObject.cmdRef</SCTSContent>
                                    </CmdRef>
                                    <Cmd>Sync</Cmd>
                                    <SCTSExecutePath xpath="Target/LocURI" return="TargetDB" target="CurrSync"/>
                                    <SCTSExecutePath xpath="Source/LocURI" return="SourceDB" target="CurrSync"/>
                                    <TargetRef>
                                        <SCTSContent>SCTSObject.TargetDB</SCTSContent>
                                    </TargetRef>
                                    <SourceRef>
                                        <SCTSContent>SCTSObject.SourceDB</SCTSContent>
                                    </SourceRef>
                                    <Data>200</Data>
                                </Status>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--Check whether v recvd Final in the prev recv. If there is Final ...it shows the end of package #4...ao v can end this current package #6 -->
                        <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
                            <!--If there if Final end the package#5 -->
                            <Final/>
                        </SCTSIf>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <!-- here v have to decide whether goto recieving package #6 or loop bk to another message of package #5:Itz ll depends on final in the prev Recv-->
            <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
                <!--If there is  if Final in the package#5 then break-->
                <SCTSBreak/>
            </SCTSIf>
        </SCTSLoop>
        <!--So if there is final(or end of package #4 and hence #5) recv the next package #6 -; package #6 ll have status for Maps sent in package #5 -->
        <SCTSRecv/>
        <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
        <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
            <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
        </SCTSIf>
        <!-- So update the anchors after the sync  before statring new session-->
        <!--Replace the remote Last anchor by  remote Next Anchor -->
        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="SCTSNULL" OP="NE">
            <SCTSSet attrib="LoopIndex" param1="1"/>
            <SCTSLoop>
                <!--Get the current DB Node -->
                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()" param1="SCTSObject.LoopIndex" return="CurrDBLocURI"/>
                <SCTSOP OP="SCTSDatabase.getRemoteNextAnchor()" param1="SCTSObject.CurrDBLocURI" return="remoteNextAnchor"/>
                <SCTSOP OP="SCTSDatabase.setRemoteLastAnchor()" param1="SCTSObject.CurrDBLocURI"
                    param2="SCTSObject.remoteNextAnchor" return="status"/>
                <!--Repalce local last anchor by localnext anchor -->
                <SCTSOP OP="SCTSDatabase.setLocalLastAnchor()" param1="SCTSObject.CurrDBLocURI"
                    param2="SCTSObject.localNextAnchor" return="status"/>
                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                    <!--If v built sync for all the dbsthen break from the loop -->
                    <SCTSBreak/>
                </SCTSIf>
                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" OP="PLUS" return="LoopIndex"/>
            </SCTSLoop>
        </SCTSIf>
    </SCTSSession>
    <SCTSIf param1="SCTSObject.executionResult" param2="Failed" OP="EQ">
        <SCTSExit/>
    </SCTSIf>
    <SCTSSession>
        <!--Here v ll run the normal test case....to test weather anchors excahnged properly in the previuos test case -->
        <!--To do Normal sync Add only one record in any one of the database the the TestObject supports -->
        <SCTSSet attrib="MaxMsgSize" param1="5000"/>
        <SCTSSet attrib="executionResult" param1="Success"/>
        <SCTSSet attrib="MaxObjSize" param1="0"/>
        <SCTSSet attrib="sessionID" param1="2"/>
        <SCTSSet attrib="msgID" param1="0"/>
        <SCTSSet attrib="FirstSend" param1="1"/>
        <SCTSOP OP="SCTSDatabase.generateNextAnchor()" return="localNextAnchor"/>
        <!--To test, weather the TestObject handles replace properly or not , clear the modifications...and replace some items added by SCTS -->
        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
            <SCTSSet attrib="LoopIndex" param1="1"/>
            <SCTSLoop>
                <!--Get the current DB Node -->
                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()" param1="SCTSObject.LoopIndex" return="CurrDBLocURI"/>
                <SCTSOP OP="SCTSContext.getLocalMimeType()" param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                <SCTSOP OP="SCTSDatabase.clearModifications()" param1="SCTSObject.CurrDBLocURI" param2="SCTSObject.SCTSNULL"/>
                <!--Get the num of record in that databse -->
                <SCTSOP OP="SCTSDatabase.getNumOfRecords()" param1="SCTSObject.CurrDBLocURI" return="NumOfRecs"/>
                <SCTSIf param1="SCTSObject.NumOfRecs" param2="0" OP="GT">
                    <SCTSSet attrib="RecLoopIndex" param1="1"/>
                    <SCTSSet attrib="SampleDataIndex" param1="1"/>
                    <SCTSLoop>
                        <SCTSOP OP="SCTSDatabase.getRecordOnIndex()"
                            param1="SCTSObject.CurrDBLocURI" param2="SCTSObject.RecLoopIndex" return="CurrRec"/>
                        <!--Check weather current rec is added by scts -->
                        <SCTSExecutePath xpath="AddedBy" return="added" target="CurrRec"/>
                        <SCTSIf param1="SCTSObject.added" param2="SCTS" OP="EQ">
                            <!--Fetch the LUID of that Data -->
                            <SCTSExecutePath xpath="DBLUID" return="LUID" target="CurrRec"/>
                            <!--Fetch the sample data -->
                            <SCTSOP OP="SCTSDatabase.getSampleReplaceData()"
                                param1="SCTSObject.locMime" param2="SCTSObject.SampleDataIndex" return="ReplaceData"/>
                            <!--Incerement the sample data index -->
                            <SCTSExpr param1="SCTSObject.SampleDataIndex" param2="1" OP="PLUS" return="SampleDataIndex"/>
                            <!--Replace the data -->
                            <SCTSOP OP="SCTSDatabase.replaceRawItem()"
                                param1="SCTSObject.CurrDBLocURI" param2="SCTSObject.ReplaceData"
                                param3="SCTSObject.LUID" return="ReplaceStatus"/>
                        </SCTSIf>
                        <SCTSIf param1="SCTSObject.RecLoopIndex" param2="SCTSObject.NumOfRecs" OP="EQ">
                            <SCTSBreak/>
                        </SCTSIf>
                        <SCTSExpr param1="SCTSObject.RecLoopIndex" param2="1" OP="PLUS" return="RecLoopIndex"/>
                    </SCTSLoop>
                </SCTSIf>
                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                    <!--If v built sync for all the dbsthen break from the loop -->
                    <SCTSBreak/>
                </SCTSIf>
                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" OP="PLUS" return="LoopIndex"/>
            </SCTSLoop>
        </SCTSIf>
        <!--In this send v check.....V ll nt send the credentails-->
        <SCTSLoop>
            <SCTSSend>
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSIf param1="SCTSObject.FirstSend" param2="1" OP="NE">
                            <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal"
                                return="Chal" target="CurrRecv"/>
                            <!--If there is chal in the curr recv -->
                            <SCTSIf param1="SCTSObject.Chal" param2="SCTSNULL" OP="NE">
                                <!--Send the credentails -->
                                <Cred>
                                    <Meta>
                                        <SCTSExecutePath
                                            xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Format"
                                            return="authFormat" target="CurrRecv"/>
                                        <SCTSExecutePath
                                            xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//Type"
                                            return="authType" target="CurrRecv"/>
                                        <SCTSExecutePath
                                            xpath="/SyncML/SyncBody/Status[CmdID='1']/Chal//NextNonce"
                                            return="NextNonce" target="CurrRecv"/>
                                        <SCTSIf param1="SCTSObject.authFormat" param2="SCTSNULL" OP="EQ">
                                            <SCTSSet attrib="authFormat" param1="b64"/>
                                        </SCTSIf>
                                        <Format xmlns="syncml:metinf">
                                            <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                        </Format>
                                        <Type xmlns="syncml:metinf">
                                            <SCTSContent>SCTSObject.authType</SCTSContent>
                                        </Type>
                                    </Meta>
                                    <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                        param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                    <Data>
                                        <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                    </Data>
                                </Cred>
                            </SCTSIf>
                        </SCTSIf>
                        <!--Send the Max Mxg size the client can handle -->
                        <SCTSOP OP="SCTSContext.getLocalMaxMsgSize()" return="MaxMsgSize"/>
                        <Meta>
                            <MaxMsgSize xmlns="syncml:metinf">
                                <SCTSContent> SCTSObject.MaxMsgSize </SCTSContent>
                            </MaxMsgSize>
                        </Meta>
                    </SyncHdr>
                    <SyncBody>
                        <SCTSSet attrib="cmdIDNo" param1="1"/>
                        <SCTSIf param1="SCTSObject.FirstSend" param2="1" OP="NE">
                            <!--If this is not a first send ..then build the status for curr Recv -->
                            <Status>
                                <CmdID>
                                    <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                </CmdID>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                                <MsgRef>
                                    <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                </MsgRef>
                                <CmdRef>0</CmdRef>
                                <Cmd>SyncHdr</Cmd>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI"
                                    return="targetID" target="CurrRecv"/>
                                <TargetRef>
                                    <SCTSContent>SCTSObject.targetID</SCTSContent>
                                </TargetRef>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI"
                                    return="sourceID" target="CurrRecv"/>
                                <SourceRef>
                                    <SCTSContent> SCTSObject.sourceID </SCTSContent>
                                </SourceRef>
                                <SCTSExecutePath xpath="/SyncML/SyncHdr/Cred" return="Cred" target="CurrRecv"/>
                                <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="NE">
                                    <Data>
                                        <SCTSContent> 212 </SCTSContent>
                                    </Data>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="EQ">
                                    <Data>
                                        <SCTSContent> 200 </SCTSContent>
                                    </Data>
                                </SCTSIf>
                            </Status>
                        </SCTSIf>
                        <!--Build the alerts for each Database,the Client wants to Sync -->
                        <SCTSSet attrib="DBIndex" param1="0"/>
                        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                            <SCTSLoop>
                                <SCTSExpr param1="SCTSObject.DBIndex" param2="1" return="DBIndex" OP="PLUS"/>
                                <!--Get the current DB Node -->
                                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                                    param1="SCTSObject.DBIndex" return="CurrDBLocURI"/>
                                <!--Fetch the matching target for the above source -->
                                <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                    param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                                <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                    param1="SCTSObject.locMime" return="targetDBLocURI"/>
                                <Alert>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <Data> 200</Data>
                                    <Item>
                                        <Source>
                                            <LocURI>
                                                <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                            </LocURI>
                                        </Source>
                                        <Target>
                                            <LocURI>
                                                <SCTSContent> SCTSObject.targetDBLocURI</SCTSContent>
                                            </LocURI>
                                        </Target>
                                        <SCTSOP OP="SCTSDatabase.getLocalLastAnchor()"
                                            param1="SCTSObject.CurrDBLocURI" return="localLastAnchor"/>
                                        <Meta>
                                            <Anchor xmlns="syncml:metinf">
                                                <Last>
                                                  <SCTSContent> SCTSObject.localLastAnchor </SCTSContent>
                                                </Last>
                                                <Next>
                                                  <SCTSContent>SCTSObject.localNextAnchor</SCTSContent>
                                                </Next>
                                            </Anchor>
                                        </Meta>
                                    </Item>
                                </Alert>
                                <SCTSIf param1="SCTSObject.DBIndex"
                                    param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                                    <!--If v built sync for all the dbsthen break from the loop -->
                                    <SCTSBreak/>
                                </SCTSIf>
                            </SCTSLoop>
                        </SCTSIf>
                        <Final/>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <SCTSIf param1="SCTSObject.FirstSend" param2="1" OP="EQ">
                <SCTSSet attrib="FirstSend" param1="0"/>
            </SCTSIf>
            <!--Get the response  -->
            <SCTSRecv/>
            <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
                <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
            </SCTSIf>
            <!--If the status for syncHdr v sent is 212(Authentication accepted) -->
            <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']/Data" return="AuthStatus" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="212" OP="EQ">
                <SCTSBreak/>
            </SCTSIf>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
                <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                    <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                        return="NextNonce" target="CurrRecv"/>
                </SCTSIf>
                <SCTSBreak/>
            </SCTSIf>
            <!--Check whether v sent credentials allready -->
            <SCTSExecutePath xpath="//Cred" return="Cred" target="CurrSend"/>
            <SCTSIf param1="SCTSObject.Cred" param2="SCTSNULL" OP="NE">
                <!--status for synchdr is not 212/200 and if v have sent credentials , then it is authentication fail-->
                <SCTSSet attrib="executionResult" param1="AuthenticationFailed"/>
                <SCTSSet attrib="FailureReason" param1="AuthenticationFailed"/>
                <!--So abort the current session -->
                <SCTSExit/>
            </SCTSIf>
        </SCTSLoop>
        <!--Client Sync send -->
        <!--In the below send v ll send the modifications from client and v ll assume that since server can handle large messges and large objects..
        all modifiacations ll fit in one package, But since server side control is not with us..server may send modifications across multiple messages
        or data by chunking , V shud in a postion to handle that-->
        <!--Client Sync send -->
        <SCTSSet attrib="ClientDBsIndex" param1="0"/>
        <SCTSSet attrib="ModIndex" param1="1"/>
        <SCTSSet attrib="WrongLUID" param1="A"/>
        <SCTSLoop>
            <SCTSSend>
                <!--Say v ll assume that client sends all modifications in one messgae  -->
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                            <Cred>
                                <Meta>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                    </SyncHdr>
                    <SyncBody>
                        <Status>
                            <SCTSSet attrib="cmdIDNo" param1="1"/>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <CmdRef>0</CmdRef>
                            <Cmd>SyncHdr</Cmd>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <Data>
                                <SCTSContent> 200 </SCTSContent>
                            </Data>
                        </Status>
                        <!--Build the status for alerts recvd -->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <!--Get the number of alerts in the CurrRecv -->
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Alert)" return="NumOfAlerts" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.NumOfAlerts" param2="0" OP="GT">
                            <SCTSLoop>
                                <SCTSExpr param1="/SyncML/SyncBody/Alert["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrAlert" target="CurrRecv"/>
                                <!--Fetch the anchors in the recvd alert,since it is slow sync just fetch the Next anchor -->
                                <SCTSExecutePath xpath="Item/Meta/Anchor/Next" return="recvdNext" target="CurrAlert"/>
                                <SCTSExecutePath xpath="Item/Source/LocURI" return="targetID" target="CurrAlert"/>
                                <SCTSOP OP="SCTSDatabase.setRemoteNextAnchor()"
                                    param1="SCTSObject.targetID" param2="SCTSObject.recvdNext" return="status"/>
                                <Status>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                    </CmdID>
                                    <MsgRef>
                                        <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                    </MsgRef>
                                    <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrAlert"/>
                                    <CmdRef>
                                        <SCTSContent> SCTSObject.cmdRef </SCTSContent>
                                    </CmdRef>
                                    <Cmd>Alert</Cmd>
                                    <SCTSExecutePath xpath="Item/Target/LocURI" return="targetID" target="CurrAlert"/>
                                    <TargetRef>
                                        <SCTSContent>SCTSObject.targetID</SCTSContent>
                                    </TargetRef>
                                    <SCTSExecutePath xpath="Item/Source/LocURI" return="sourceID" target="CurrAlert"/>
                                    <SourceRef>
                                        <SCTSContent> SCTSObject.sourceID </SCTSContent>
                                    </SourceRef>
                                    <Data>
                                        <SCTSContent>200</SCTSContent>
                                    </Data>
                                    <Item>
                                        <Data>
                                            <Anchor xmlns="syncml:metinf">
                                                <Next>
                                                  <SCTSContent> SCTSObject.recvdNext </SCTSContent>
                                                </Next>
                                            </Anchor>
                                        </Data>
                                    </Item>
                                </Status>
                                <SCTSIf param1="SCTSObject.LoopIndex"
                                    param2="SCTSObject.NumOfAlerts" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1" OP="PLUS" return="LoopIndex"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--For all sync Nodes in the prev send ..check wether v sent any replaces..so for the testcase to pass v must recv ststus 
                    commnd Replace -->
                        <!-- Check  weather v sent sync in the prev send-->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="PrevSend"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the cuurrent SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="PrevSend"/>
                                <!--get the targret uri -->
                                <SCTSExecutePath xpath="Target/LocURI" return="CurrDBLocURI" target="CurrSync"/>
                                <!--Check weatehr v sent any Reaplec as part of this current sync -->
                                <SCTSExecutePath xpath="count(Replace)" return="NumOfReplace" target="CurrSync"/>
                                <SCTSIf param1="SCTSObject.NumOfReplace" param2="0" OP="GT">
                                    <SCTSSet attrib="InnerLoopIndex" param1="1"/>
                                    <SCTSLoop>
                                        <!--Get the cuurrent ReplaceNode since v sent the replace for non existent data ..v must recv status code 201(Item added)-->
                                        <SCTSExpr param1="Replace["
                                            param2="SCTSObject.InnerLoopIndex" return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExecutePath xpath="SCTSObject.xPathQuerry"
                                            return="CurrReplace" target="CurrSync"/>
                                        <!--Check for the status recvd  -->
                                        <SCTSExecutePath xpath="CmdID" return="sendCmdID" target="CurrReplace"/>
                                        <SCTSExpr param1="/SyncML/SyncBody/Status[CmdRef="
                                            param2="SCTSObject.sendCmdID" OP="PLUS" return="xpathString"/>
                                        <SCTSExpr param1="SCTSObject.xpathString" param2="]/Data"
                                            OP="PLUS" return="xpathString"/>
                                        <SCTSExecutePath xpath="SCTSObject.xpathString"
                                            target="CurrRecv" return="statusVal"/>
                                        <SCTSIf param1="SCTSObject.statusVal" param2="201" OP="NE">
                                            <SCTSSet attrib="executionResult" param1="Failed"/>
                                            <SCTSSet attrib="FailureReason" param1="Replace failed"/>
                                        </SCTSIf>
                                        <SCTSIf param1="SCTSObject.InnerLoopIndex"
                                            param2="SCTSObject.NumOfReplace" OP="EQ">
                                            <SCTSBreak/>
                                        </SCTSIf>
                                        <SCTSExpr param1="SCTSObject.InnerLoopIndex" param2="1"
                                            return="InnerLoopIndex" OP="PLUS"/>
                                    </SCTSLoop>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--#################################################################### -->
                        <!--***************************************************************************************************** -->
                        <!--Build the sync for each database the SCTS supports -->
                        <SCTSOP OP="SCTSContext.getNumOfLocalDatabases()" return="NumOfLocalDBs"/>
                        <SCTSIf param1="SCTSObject.NumOfLocalDBs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Check wether next sync fits or not -->
                                <SCTSExecutePath xpath="string-length(/SyncML)" target="CurrSend" return="CurrentSize"/>
                                <!--25 bytes as to b reserved for </Final></SynaBody><SyncML> -->
                                <SCTSExpr param1="SCTSObject.CurrentSize" param2="25"
                                    return="tempSize" OP="PLUS"/>
                                <!--Say the size of next sync appr 200 bytes -->
                                <SCTSExpr param1="SCTSObject.tempSize" param2="200"
                                    return="syncTempSize" OP="PLUS"/>
                                <!--If the current sync unable to fit in then break from the loop -->
                                <SCTSIf param1="SCTSObject.syncTempSize"
                                    param2="SCTSObject.MaxMsgSize" OP="GT">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <!--Get the current DB Node -->
                                <SCTSExpr param1="SCTSObject.ClientDBsIndex" param2="1"
                                    return="TempClientDBsIndex" OP="PLUS"/>
                                <SCTSOP OP="SCTSContext.getLocalDBLocURI_onIndex()"
                                    param1="SCTSObject.TempClientDBsIndex" return="CurrDBLocURI"/>
                                <Sync>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <Source>
                                        <LocURI>
                                            <SCTSContent>SCTSObject.CurrDBLocURI</SCTSContent>
                                        </LocURI>
                                    </Source>
                                    <!--Fetch the matching target for the above source -->
                                    <SCTSOP OP="SCTSContext.getLocalMimeType()"
                                        param1="SCTSObject.CurrDBLocURI" return="locMime"/>
                                    <SCTSOP OP="SCTSContext.getRemoteDBLocURI_onMime()"
                                        param1="SCTSObject.locMime" return="targetID"/>
                                    <Target>
                                        <LocURI>
                                            <SCTSContent>SCTSObject.targetID</SCTSContent>
                                        </LocURI>
                                    </Target>
                                    <SCTSOP OP="SCTSDatabase.getNumberOfModifications() "
                                        param1="SCTSObject.CurrDBLocURI" param2="Replace" return="NumOfReplaces"/>
                                    <SCTSIf param1="SCTSObject.NumOfReplaces" param2="0" OP="GT">
                                        <!--Get the modification list -->
                                        <SCTSLoop>
                                            <!--Fetch the current replace  -->
                                            <SCTSOP OP="SCTSDatabase.getModificationOnIndex()"
                                                param1="SCTSObject.CurrDBLocURI" param2="Replace"
                                                param3="SCTSObject.ModIndex" return="CurrReplace"/>
                                            <!--Find the size of the add -->
                                            <SCTSExecutePath xpath="string-length(DBRecord)"
                                                target="CurrReplace" return="ReplaceSize"/>
                                            <SCTSExpr param1="SCTSObject.syncTempSize"
                                                param2="SCTSObject.ReplaceSize"
                                                return="TotalMsgSize" OP="PLUS"/>
                                            <!--If the  current replace fits in-->
                                            <SCTSIf param1="SCTSObject.TotalMsgSize"
                                                param2="SCTSObject.MaxMsgSize" OP="LT">
                                                <Replace>
                                                  <SCTSExpr param1="cmdIDNo" param2="1"
                                                  return="cmdIDNo" OP="PLUS"/>
                                                  <CmdID>
                                                  <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                                                  </CmdID>
                                                  <Meta>
                                                  <Type xmlns="syncml:metinf">
                                                  <SCTSContent>SCTSObject.locMime</SCTSContent>
                                                  </Type>
                                                  </Meta>
                                                  <Item>
                                                  <Source>
                                                  <!-- For this test case send some nonexistent LUIDs -->
                                                  <SCTSExpr param1="SCTSObject.WrongLUID"
                                                  param2="A" OP="PLUS" return="WrongLUID"/>
                                                  <LocURI>
                                                  <SCTSContent>SCTSObject.WrongLUID</SCTSContent>
                                                  </LocURI>
                                                  </Source>
                                                  <SCTSExecutePath xpath="DBData"
                                                  target="CurrReplace" return="data"/>
                                                  <Data>

                                                  <SCTSContent>SCTSObject.data</SCTSContent>s </Data>
                                                  </Item>
                                                </Replace>
                                            </SCTSIf>
                                            <SCTSIf param1="SCTSObject.ModIndex"
                                                param2="SCTSObject.NumOfReplaces" OP="EQ">
                                                <SCTSSet attrib="ModIndex" param1="1"/>
                                                <SCTSExpr param1="SCTSObject.ClientDBsIndex"
                                                  param2="1" return="ClientDBsIndex" OP="PLUS"/>
                                                <SCTSBreak/>
                                            </SCTSIf>
                                            <SCTSExpr param1="SCTSObject.ModIndex" param2="1"
                                                return="ModIndex" OP="PLUS"/>
                                        </SCTSLoop>
                                    </SCTSIf>
                                    <!--If there is no modifictions to send then move to next sync -->
                                    <SCTSIf param1="SCTSObject.NumOfReplaces" param2="0" OP="EQ">
                                        <SCTSExpr param1="SCTSObject.ClientDBsIndex" param2="1"
                                            return="ClientDBsIndex" OP="PLUS"/>
                                    </SCTSIf>
                                </Sync>
                                <SCTSIf param1="SCTSObject.ClientDBsIndex"
                                    param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                                    <!--If v built sync for all the dbsthen break from the loop -->
                                    <SCTSBreak/>
                                </SCTSIf>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--***************************************************************************************************** -->
                        <!--If v r able to send sync command for all dbs client support then end the package #4 -->
                        <SCTSIf param1="SCTSObject.ClientDBsIndex" param2="SCTSObject.NumOfLocalDBs" OP="EQ">
                            <Final/>
                        </SCTSIf>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <SCTSBreak/>
        </SCTSLoop>
        <!--ServerSync Send -->
        <SCTSLoop>
            <!--The below recv(package #4) ...ll have status for modificatins sent in prev send(package #3) ...and modifications from server(Modifications may run across multiple messges) -->
            <SCTSRecv/>
            <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
                <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
            </SCTSIf>
            <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                <!-- If the auth status is 200 then v need to send credentials ,if the auth type is md5, then use the recvd nonce for next message credentails -->
                <SCTSIf param1="SCTSObject.authType" param2="syncml:auth-md5" OP="EQ">
                    <SCTSExecutePath xpath="/SyncML/SyncBody/Status[CmdRef='0']//NextNonce"
                        return="NextNonce" target="CurrRecv"/>
                </SCTSIf>
            </SCTSIf>
            <!--In the next send Build the status for adds and send Maps for completly recvd adds -->
            <SCTSSend>
                <SyncML xmlns="SYNCML:SYNCML1.2">
                    <SyncHdr>
                        <VerDTD>1.2</VerDTD>
                        <VerProto>SyncML/1.2</VerProto>
                        <SessionID>
                            <SCTSContent>SCTSObject.sessionID</SCTSContent>
                        </SessionID>
                        <MsgID>
                            <SCTSExpr param1="msgID" param2="1" return="msgID" OP="PLUS"/>
                            <SCTSContent>SCTSObject.msgID</SCTSContent>
                        </MsgID>
                        <SCTSOP OP="SCTSContext.getRemoteDeviceAddress()" return="targetID"/>
                        <Target>
                            <LocURI>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </LocURI>
                        </Target>
                        <Source>
                            <LocURI>
                                <SCTSOP OP="SCTSContext.getLocalDeviceAddress()" return="sourceID"/>
                                <SCTSContent> SCTSObject.sourceID</SCTSContent>
                            </LocURI>
                            <LocName>
                                <SCTSOP OP="SCTSContext.getRemoteDeviceName()" return="sourceName"/>
                                <SCTSContent>SCTSObject.sourceName</SCTSContent>
                            </LocName>
                        </Source>
                        <SCTSIf param1="SCTSObject.AuthStatus" param2="200" OP="EQ">
                            <Cred>
                                <Meta>
                                    <Format xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authFormat</SCTSContent>
                                    </Format>
                                    <Type xmlns="syncml:metinf">
                                        <SCTSContent>SCTSObject.authType</SCTSContent>
                                    </Type>
                                </Meta>
                                <SCTSOP OP="SCTSContext.getRemoteCredentials()"
                                    param1="SCTSObject.authType" param2="SCTSObject.NextNonce" return="SCTSCredentials"/>
                                <Data>
                                    <SCTSContent>SCTSObject.SCTSCredentials</SCTSContent>
                                </Data>
                            </Cred>
                        </SCTSIf>
                    </SyncHdr>
                    <SyncBody>
                        <Status>
                            <SCTSSet attrib="cmdIDNo" param1="1"/>
                            <CmdID>
                                <SCTSContent> SCTSObject.cmdIDNo </SCTSContent>
                            </CmdID>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/MsgID" return="TOMsgID" target="CurrRecv"/>
                            <MsgRef>
                                <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                            </MsgRef>
                            <CmdRef>0</CmdRef>
                            <Cmd>SyncHdr</Cmd>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Target/LocURI" return="targetID" target="CurrRecv"/>
                            <TargetRef>
                                <SCTSContent>SCTSObject.targetID</SCTSContent>
                            </TargetRef>
                            <SCTSExecutePath xpath="/SyncML/SyncHdr/Source/LocURI" return="sourceID" target="CurrRecv"/>
                            <SourceRef>
                                <SCTSContent> SCTSObject.sourceID </SCTSContent>
                            </SourceRef>
                            <Data>
                                <SCTSContent> 200 </SCTSContent>
                            </Data>
                        </Status>
                        <!-- Check the status for the Replace v sent in the prev send -->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="PrevSend"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the current SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="PrevSend"/>
                                <!--get the targret uri -->
                                <SCTSExecutePath xpath="Target/LocURI" return="CurrDBLocURI" target="CurrSync"/>
                                <!--Check weatehr v sent any Reaplec as part of this current sync -->
                                <SCTSExecutePath xpath="count(Replace)" return="NumOfReplace" target="CurrSync"/>
                                <SCTSIf param1="SCTSObject.NumOfReplace" param2="0" OP="GT">
                                    <SCTSSet attrib="InnerLoopIndex" param1="1"/>
                                    <SCTSLoop>
                                        <!--Get the cuurrent ReplaceNode since v sent replace on nonexistent LUID, v must get status 201(Item added instaed of 200)-->
                                        <SCTSExpr param1="Replace["
                                            param2="SCTSObject.InnerLoopIndex" return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                            return="xPathQuerry" OP="PLUS"/>
                                        <SCTSExecutePath xpath="SCTSObject.xPathQuerry"
                                            return="CurrReplace" target="CurrSync"/>
                                        <!--Check for the status recvd  -->
                                        <SCTSExecutePath xpath="CmdID" return="sendCmdID" target="CurrReplace"/>
                                        <SCTSExpr param1="/SyncML/SyncBody/Status[CmdRef="
                                            param2="SCTSObject.sendCmdID" OP="PLUS" return="xpathString"/>
                                        <SCTSExpr param1="SCTSObject.xpathString" param2="]/Data"
                                            OP="PLUS" return="xpathString"/>
                                        <SCTSExecutePath xpath="SCTSObject.xpathString"
                                            target="CurrRecv" return="statusVal"/>
                                        <SCTSIf param1="SCTSObject.statusVal" param2="201" OP="NE">
                                            <SCTSSet attrib="executionResult" param1="Failed"/>
                                            <SCTSSet attrib="FailureReason" param1="Replace failed"/>
                                        </SCTSIf>
                                        <SCTSIf param1="SCTSObject.InnerLoopIndex"
                                            param2="SCTSObject.NumOfReplace" OP="EQ">
                                            <SCTSBreak/>
                                        </SCTSIf>
                                        <SCTSExpr param1="SCTSObject.InnerLoopIndex" param2="1"
                                            return="InnerLoopIndex" OP="PLUS"/>
                                    </SCTSLoop>
                                </SCTSIf>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--Build the status for each sync recvd from server  -->
                        <SCTSSet attrib="LoopIndex" param1="1"/>
                        <SCTSExecutePath xpath="count(/SyncML/SyncBody/Sync)" return="NumOfSyncs" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.NumOfSyncs" param2="0" OP="GT">
                            <SCTSLoop>
                                <!--Get the cuurrent SyncNode -->
                                <SCTSExpr param1="/SyncML/SyncBody/Sync["
                                    param2="SCTSObject.LoopIndex" return="xPathQuerry" OP="PLUS"/>
                                <SCTSExpr param1="SCTSObject.xPathQuerry" param2="]"
                                    return="xPathQuerry" OP="PLUS"/>
                                <SCTSExecutePath xpath="SCTSObject.xPathQuerry" return="CurrSync" target="CurrRecv"/>
                                <Status>
                                    <SCTSExpr param1="cmdIDNo" param2="1" return="cmdIDNo" OP="PLUS"/>
                                    <CmdID>
                                        <SCTSContent>SCTSObject.cmdIDNo</SCTSContent>
                                    </CmdID>
                                    <MsgRef>
                                        <SCTSContent>SCTSObject.TOMsgID</SCTSContent>
                                    </MsgRef>
                                    <SCTSExecutePath xpath="CmdID" return="cmdRef" target="CurrSync"/>
                                    <CmdRef>
                                        <SCTSContent>SCTSObject.cmdRef</SCTSContent>
                                    </CmdRef>
                                    <Cmd>Sync</Cmd>
                                    <SCTSExecutePath xpath="Target/LocURI" return="TargetDB" target="CurrSync"/>
                                    <SCTSExecutePath xpath="Source/LocURI" return="SourceDB" target="CurrSync"/>
                                    <TargetRef>
                                        <SCTSContent>SCTSObject.TargetDB</SCTSContent>
                                    </TargetRef>
                                    <SourceRef>
                                        <SCTSContent>SCTSObject.SourceDB</SCTSContent>
                                    </SourceRef>
                                    <Data>200</Data>
                                </Status>
                                <SCTSIf param1="SCTSObject.LoopIndex" param2="SCTSObject.NumOfSyncs" OP="EQ">
                                    <SCTSBreak/>
                                </SCTSIf>
                                <SCTSExpr param1="SCTSObject.LoopIndex" param2="1"
                                    return="LoopIndex" OP="PLUS"/>
                            </SCTSLoop>
                        </SCTSIf>
                        <!--Check whether v recvd Final in the prev recv. If there is Final ...it shows the end of package #4...ao v can end this current package #6 -->
                        <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
                        <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
                            <!--If there if Final end the package#5 -->
                            <Final/>
                        </SCTSIf>
                    </SyncBody>
                </SyncML>
            </SCTSSend>
            <!-- here v have to decide whether goto recieving package #6 or loop bk to another message of package #5:Itz ll depends on final in the prev Recv-->
            <SCTSExecutePath xpath="/SyncML/SyncBody/Final" return="Final" target="CurrRecv"/>
            <SCTSIf param1="SCTSObject.Final" param2="SCTSNULL" OP="NE">
                <!--If there is  if Final in the package#5 then break-->
                <SCTSBreak/>
            </SCTSIf>
        </SCTSLoop>
        <!--So if there is final(or end of package #4 and hence #5) recv the next package #6 -; package #6 ll have status for Maps sent in package #5 -->
        <SCTSRecv/>
        <SCTSExecutePath xpath="/SyncML/SyncHdr/RespURI" return="responseURI" target="CurrRecv"/>
        <SCTSIf param1="SCTSObject.responseURI" param2="SCTSNULL" OP="NE">
            <SCTSOP OP="SCTSContext.setResponseURI()" param1="SCTSObject.responseURI" return="retVal"/>
        </SCTSIf>
    </SCTSSession>
</TestCase>
